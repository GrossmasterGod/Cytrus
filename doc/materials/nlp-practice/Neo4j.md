# Переваги графових баз даних
* Графи зрозумілі на інтуїтивному рівні і є частиною шкільної програми, тому їх можна використовувати під час обговорення завдань з клієнтом;
* Проста мова запитів і наочний результат, тому може використовуватися аналітиками;
* Гнучка структура даних, простіше вносити зміни у разі зміни вимог;
* Можливість створення наближених до реального життя моделей, без низькорівневих деталей.

# Neo4j
Neo4j — графова система управління базами даних. Найпопулярніша СУБД за оцінками сайту db-engines.com станом на листопад 2019. Використовує мову запитів Cypher.

Neo4j може взаємодіяти з БД за одним з протоколів:
* HTTP
* HTTPS
* BOLT (Собственный протокол Neo Technology)

У Neo4j є різні способи взаємодії та використання графічних даних. 

Компоненти графічної платформи Neo4j:

![](https://s3.amazonaws.com/dev.assets.neo4j.com/wp-content/uploads/neo4j_graph_platform.jpg)

Кожен із перелічених нижче елементів був розроблений для заповнення ділової або технічної потреби на зображенні вище.

+ *Neo4j Graph Database* - наша основна база даних графіків, яка створена для зберігання та отримання підключених даних. Є два видання - Community Edition та Enterprise Edition. Все на нашій платформі взаємодіє з даними, що зберігаються в базі даних.
+ *Neo4j Desktop* - додаток для управління локальними екземплярами Neo4j. Безкоштовне завантаження включає ліцензію Neo4j Enterprise Edition.
+ *Neo4j Browser* - Інтернет-інтерфейс браузера для запиту та перегляду даних у базі даних. Основні можливості візуалізації за допомогою мови запиту Cypher.
+ *Neo4j Bloom* - інструмент візуалізації для ділових користувачів, який не потребує коду чи навичок програмування для перегляду та аналізу даних. Документація також доступна в нашому розділі документів.

Neo4j також має різноманітні бібліотеки розширень та інструменти для розробників, які можна додати до існуючих продуктів для підвищення функціональності.

__Платформа:__	Віртуальна машина Java

__Написано на:__	Java і Scala

__Репозиторій:__ https://github.com/neo4j/neo4j

__Мануал:__ https://neo4j.com/docs/cypher-manual/current/

__Картинка взята з:__ https://neo4j.com/developer/graph-platform/#platform-components

# Cypher
Cypher - мова запитів графіків Neo4j, яка дозволяє користувачам зберігати та отримувати дані з бази даних графіків. Cypher покликаний бути простим, але потужним; дуже складні запити до бази даних можуть бути легко виражені, що дозволяє зосередитись на вашому домені, а не втрачати доступ у базі даних.

Синтаксис Cypher забезпечує візуальний та логічний спосіб узгодження зразків вузлів та зв’язків на графіку. Це декларативна, натхненна SQL мова для опису візуальних моделей у графіках за допомогою синтаксису ASCII-Art. Це дозволяє нам заявити, що ми хочемо зробити з нашими даними без опису того, як саме це зробити. Через Cypher користувачі можуть створювати виразні та ефективні запити для обробки необхідних функцій створення, читання, оновлення та видалення. 

Cypher натхненний низкою різних підходів і ґрунтується на усталеній практиці експресивного запиту. Відповідність шаблонів запозичує підходи до вираження з SPARQL. Частина семантики списку запозичена з таких мов, як Haskell та Python. Конструкції Cypher, засновані на англійській прозі та акуратній іконографії.

Нижче наведено кілька команд:

__MATCH:__ Це найпоширеніший спосіб отримання даних із графіка.

__WHERE:__ Не власне застереження, а скоріше частина MATCH, OPTIONAL MATCH та WITH. Додає обмеження для шаблону або фільтрує проміжний результат, що проходить через WITH.

__RETURN:__ Що повернути.

__CREATE__  (і __DELETE__): створюйте (і видаляйте) вузли та зв’язки.

__SET__ (і __REMOVE__): встановлення значень властивостей та додавання міток на вузлах за допомогою SET та використання REMOVE для їх видалення.

__MERGE:__ Зіставлення існуючих або створення нових вузлів і шаблонів. Це особливо корисно разом з унікальними обмеженнями.

# Neo4j NLP

GraphAware це плагін Neo4j, який пропонує можливості обробки природних мов на основі графіка.

The main module, this module, provide a common interface for underlying text processors as well as a Domain Specific Language built atop stored procedures and functions making your Natural Language Processing workflow developer friendly.
Основний модуль надає загальний інтерфейс для основних текстових процесорів, так само як Domain Specific Language, побудований на збережені процедур та функцій, що сприяє полегшенню життя розробнику робочого процесу з обробки природних мов.

Він поставляється у двох версіях, Community (з відкритим джерелом) та Enterprise із такими функціями NLP:

## Можливості:

| | Community Edition | Enterprise Edition |
| --- | :---: | :---: |
| Вилучення текстової інформації | ✔ | ✔ |
| Багатомовність в одній БД | | ✔ |
| Спеціальний конструктор моделі NamedEntityRecognition | | ✔ |
| Вилучення ключових слів | ✔ | ✔ |
| Підсумок TextRank | ✔ | ✔ |
| Вилучення тем | | ✔ |
| Вбудовані слова (Word2Vec) | ✔ | ✔ |
| Обчислення подібності | ✔ | ✔ |
| Розбір файлів PDF | ✔ | ✔ |
| Інтерфейс користувача | | ✔ |
| Можливості прогнозування ML | | ✔ |

Доступні дві реалізації процесорів NLP, відповідно Stanford NLP і OpenNLP (OpenNLP отримує рідкісні оновлення, рекомендується StanfordNLP).

[Більше про GraphAware: ](https://github.com/graphaware/neo4j-nlp)

# Приклад 
Розглянемо як приклад БД "Movie" за допомогою Neo4j Browser

[Джерело]( https://medium.com/@sofakingcode/%D1%8D%D0%BA%D1%81%D0%BA%D1%83%D1%80%D1%81-%D0%B2-%D0%B3%D1%80%D0%B0%D1%84%D0%BE%D0%B2%D0%B0%D1%8F-%D0%B1%D0%B0%D0%B7%D1%83-%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85-neo4j-9d5c515186e8 )

![pict](https://miro.medium.com/max/1932/1*Ut6MhmAErgU3pjqmWHa32w.png)

Для початку знайдемо актора Тома Хенкса, написавши запит на Cypher: 

![](https://miro.medium.com/max/1950/1*We_M2_NWqxcfu1rjqHoOcA.png)

__MATCH - аналог WHERE, в круглих дужках ми описуємо властивості вершини (умова пошуку), а RETURN - аналог SELECT, в ньому ми описуємо, що повернути.__
![](https://miro.medium.com/max/1918/1*OgOxG9X48foG3F0p7P5t6Q.png)

Тепер пошукаємо фільми, в яких знімався Том Хенкс.
![](https://miro.medium.com/max/2160/1*yAE6wBOKe5DlZHypE82Upw.png)

![](https://miro.medium.com/max/1914/1*6y013hTbwgp7VDIH2X6v9g.png)

Тепер подивимося, хто знімався з Томом на одному майданчику, і в якому фільмі:
![](https://miro.medium.com/max/2152/1*5JizxmJEiP3mE8fuQHBZIw.png)

![](https://miro.medium.com/max/2132/1*GfzWnHYtfui05aySiPQ3eg.png)

Текст запиту наближений до текстового відображення графа:
![](https://miro.medium.com/max/1310/1*KyPPVmwB0JuYQZMh4gEm2g.png)

Від вершини типу Person з ім'ям Tom Hanks по ребру ACTED_IN знаходяться всі вершини Movie, в яких знімався актор, від вершин типу Movie по зв'язку ACTED_IN йде пошук всіх акторів, що знялися в кожному знайденому фільмі відповідно.
![](https://miro.medium.com/max/2164/1*fbZp0MD1weTPqgrcNTwrHA.png)

# Neo4j Browser
[Джерело](https://habr.com/ru/post/470541/)

Для початку переконаємося, що Neo4j запущена (приклад для Linux):

```
service --status-all | grep neo4j

  [+] Neo4j
```
Знак "плюс" означає, що СУБД вже запущена, "мінус" - ще немає. Для запуску Neo4j виконайте команду:

` sudo service neo4j start `

Після запуску перейдіть за посиланням http://localhost:7474/browser/. Ви повинні побачити інтерфейс Neo4j Browser представлений на зображенні вище. Зараз нас будуть цікавити два елементи інтерфейсу, зображені нижче: редактор і підручник.

![](https://habrastorage.org/webt/v8/wp/tq/v8wptqht59-qwk96cttkvqug2ws.png)

## Підручник
Neo4j надає чудовий інтерактивний підручник для початківців. Просто клацніть на Start Learning і спочатку ознайомтеся з основними поняттями Neo4j:

![](https://habrastorage.org/webt/mz/u1/ds/mzu1dsfo4joymzqrga_hyodctxy.png)

По досягненню останнього кроку клацніть на Intro і ознайомтеся з можливостями Neo4j Browser:

![](https://habrastorage.org/webt/he/nz/7s/henz7shrxxyafa1knj7f4dubkza.png)

## Редактор
У верхній частині вікна Neo4j Browser розташовується рядок так званого редактора:

![](https://habrastorage.org/webt/xi/qf/-1/xiqf-1qbq3hug3wx2uvvdbeygxw.png)

Починаючи набір команд з двокрапки, побачимо список всіх доступних команд з коротким описом:

![](https://habrastorage.org/webt/n2/yr/zf/n2yrzfodvawpnsoig_n-xh4b6-e.png)

Щоб ознайомитися з прикладами роботи з графами можна вибрати: play movie graph або: play northwind graph.

Ми не будемо тут розглядати ці приклади, а розглянемо як створити свій граф за допомогою мови Cypher.

## Cтворюємо граф
Для початку можна ознайомитися з мовою Cypher, викликавши команду:

` :play cypher `

![](https://habrastorage.org/webt/ow/us/pt/owuspt4jbmxzisnhvz1bj5dtgju.png)

Створимо невеликий соціальний граф. Перейдемо в редактор і наберемо першу команду на мові Cypher:

` CREATE (u1: Person {name: "Evgeny", from: "Krasnodar"}) `

Після виконання команди Browser повідомить нам результат:

![](https://habrastorage.org/webt/hq/pm/xn/hqpmxnszfc6qjxnjxg316epovla.png)

Додамо ще один вузол:

` CREATE (u2: Person {name: "Dmitry", from: "Tula"}) `

Тепер запитаємо всі вузли типу Person і виділемо значення властивості name:

` MATCH (ee: Person) RETURN ee.name `

![](https://habrastorage.org/webt/df/ck/7k/dfck7kxo3vc8hrqlux9tvees1i0.png)

*Примітка.* Як і в SQL є можливість впорядкувати видобувні дані з якого-небудь полю:

` MATCH (ee: Person) RETURN ee.name ORDER BY ee.name `

Далі можемо запросити всі вузли даного типу:

` MATCH (ee: Person) RETURN ee `

![](https://habrastorage.org/webt/_y/9b/lt/_y9blt6twxnu7h7izztrqw4egi4.png)

Зверніть увагу на нову кнопку Graph. Клацніть по ній і побачимо наші вузли в графічному вигляді:

![](https://habrastorage.org/webt/rm/ja/xv/rmjaxv6fhwobxdcrkfkyhtjiupq.png)

*Примітка.* У версії 3.4 за замовчуванням як-раз відкривається графічне представлення. Для отримання табличного представлення потрібно клацнути на кнопку з написом "Table". Хоча, буває і навпаки.

Додамо зв'язок між вузлами:

```
MATCH (e: Person) WHERE e.name = "Evgeny"
MATCH (d: Person) WHERE d.name = "Dmitry"
CREATE (e) - [: KNOWS] -> (d),
   (D) - [: KNOWS] -> (e)
```

І знову запитаємо наш граф:

![](https://habrastorage.org/webt/sa/xz/f1/saxzf1-4xjxqwjl7onq5-0jkjn0.png)
